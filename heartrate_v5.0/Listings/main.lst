C51 COMPILER V9.60.7.0   MAIN                                                              05/14/2024 01:41:02 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\APP-Keil5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\ma
                    -in.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REG52.H>
   2          #include <intrins.h>     //                      åŒ…å«å¤´æ–‡ä»¶
   3          
   4          #define uint            unsigned int
   5          #define uchar           unsigned char
   6          #define ulong           unsigned long    //å®å®šä¹‰
   7          #define LCD_DATA        P0                               //å®šä¹‰P0å£ä¸ºLCD_DATA
   8          
   9          sbit LCD_RS =P2^5;
  10          sbit LCD_RW =P2^6;
  11          sbit LCD_E  =P2^7;                                               //å®šä¹‰LCDæ§åˆ¶å¼•è„š
  12          
  13          sbit Xintiao =P1^0 ;                                     //è„‰ææ£€æµ‹è¾“å…¥ç«¯å®šä¹‰
  14          sbit speaker =P2^4;                                              //èœ‚é¸£å™¨å¼•è„šå®šä¹‰
  15          
  16          void delay5ms(void);   //è¯¯å·® 0us
  17          void LCD_WriteData(uchar LCD_1602_DATA);         /********LCD1602æ•°æ®å†™å…¥***********/
  18          void LCD_WriteCom(uchar LCD_1602_COM);           /********LCD1602å‘½ä»¤å†™å…¥***********/
  19          void lcd_1602_word(uchar Adress_Com,uchar Num_Adat,uchar *Adress_Data); /*1602å­—ç¬¦æ˜¾ç¤ºå‡½æ•°ï¼Œå˜é‡ä
             -¾æ¬¡ä¸ºå­—ç¬¦æ˜¾ç¤ºé¦–åœ°å€ï¼Œæ˜¾ç¤ºå­—ç¬¦é•¿åº¦ï¼Œæ‰€æ˜¾ç¤ºçš„å­—ç¬¦*/
  20          void InitLcd();//æ¶²æ™¶åˆå§‹åŒ–å‡½æ•°
  21          
  22          void Tim_Init();
  23          
  24          uchar Xintiao_Change=0;    //
  25          uint  Xintiao_Jishu;
  26          uchar stop;
  27          uchar View_Data[3];
  28          uchar View_L[3];
  29          uchar View_H[3];
  30          uchar Xintiao_H=100;    //è„‰æä¸Šé™
  31          uchar Xintiao_L=40;             //è„‰æä¸‹é™
  32          
  33          
  34          uchar Key_Change;
  35          uchar Key_Value;                //æŒ‰é”®é”®å€¼
  36          uchar View_Con;                 //è®¾ç½®çš„ä½ï¼ˆ0æ­£å¸¸å·¥ä½œï¼Œ1è®¾ç½®ä¸Šé™ï¼Œ2è®¾ç½®ä¸‹é™ï¼‰
  37          uchar View_Change;
  38          
  39          void main()       //ä¸»å‡½æ•°
  40          {
  41   1       InitLcd();
  42   1       Tim_Init();
  43   1       lcd_1602_word(0x80,16,"Heart Rate:     ");       //åˆå§‹åŒ–æ˜¾ç¤º
  44   1       TR0=1;
  45   1       TR1=1;                           //æ‰“å¼€å®šæ—¶å™¨
  46   1       while(1)                         //è¿›å…¥å¾ªç¯
  47   1        {
  48   2         if(Key_Change)         //æœ‰æŒ‰é”®æŒ‰ä¸‹å¹¶å·²ç»å¾—å‡ºé”®å€¼
  49   2          {
  50   3               Key_Change=0;    //å°†æŒ‰é”®ä½¿èƒ½å˜é‡æ¸…é›¶ï¼Œç­‰å¾…ä¸‹æ¬¡æŒ‰é”®æŒ‰ä¸‹
  51   3               View_Change=1;
  52   3               switch(Key_Value)                              //åˆ¤æ–­é”®å€¼
  53   3                {
C51 COMPILER V9.60.7.0   MAIN                                                              05/14/2024 01:41:02 PAGE 2   

  54   4                 case 1:                                              //è®¾ç½®é”®æŒ‰ä¸‹
  55   4                       {
  56   5                                View_Con++;                   //è®¾ç½®çš„ä½åŠ 
  57   5                                if(View_Con==3)               //éƒ½è®¾ç½®å¥½åå°†æ­¤å˜é‡æ¸…é›¶
  58   5                                 View_Con=0;
  59   5                                break;                                //è·³å‡ºï¼Œä¸‹åŒ
  60   5                               }
  61   4                 case 2:                                              //åŠ é”®æŒ‰ä¸‹
  62   4                       {
  63   5                                if(View_Con==2)               //åˆ¤æ–­æ˜¯è®¾ç½®ä¸Šé™
  64   5                                 {
  65   6                                      if(Xintiao_H<150)       //ä¸Šé™æ•°å€¼å°äº150
  66   6                                       Xintiao_H++;           //ä¸Šé™+
  67   6                                 }
  68   5                                if(View_Con==1)               //å¦‚æœæ˜¯è®¾ç½®ä¸‹é™
  69   5                                 {
  70   6                                      if(Xintiao_L<Xintiao_H-1)//ä¸‹é™å€¼å°äºä¸Šé™-1ï¼ˆä¸‹é™å€¼ä¸èƒ½è¶…è¿‡ä¸Šé™ï¼‰
  71   6                                       Xintiao_L++;           //ä¸‹é™å€¼åŠ 
  72   6                                 }
  73   5                                break;
  74   5                               }
  75   4                 case 3:                                              //å‡é”®æŒ‰ä¸‹
  76   4                       {
  77   5                                if(View_Con==2)               //è®¾ç½®ä¸Šé™
  78   5                                 {
  79   6                                      if(Xintiao_H>Xintiao_L+1)//ä¸Šé™æ•°æ®å¤§äºä¸‹é™+1ï¼ˆåŒæ ·ä¸Šé™å€¼ä¸èƒ½å°äºä¸‹é™ï¼‰
  80   6                                       Xintiao_H--;           //ä¸Šé™æ•°æ®å‡
  81   6                                 }
  82   5                                if(View_Con==1)               //è®¾ç½®ä¸‹é™
  83   5                                 {
  84   6                                      if(Xintiao_L>30)        //ä¸‹é™æ•°æ®å¤§äº30æ—¶
  85   6                                       Xintiao_L--;           //ä¸‹é™æ•°æ®å‡
  86   6                                 }
  87   5                                break;
  88   5                               } 
  89   4               }
  90   3              }
  91   2         if(View_Change)//å¼€å§‹æ˜¾ç¤ºå˜é‡
  92   2          {
  93   3               View_Change=0;//å˜é‡æ¸…é›¶
  94   3               if(stop==0)                      //å¿ƒç‡æ­£å¸¸æ—¶
  95   3                {
  96   4                 if(View_Data[0]==0x30) //æœ€é«˜ä½ä¸º0æ—¶ä¸æ˜¾ç¤º
  97   4                  View_Data[0]=' ';
  98   4                }
  99   3               else                                     //å¿ƒç‡ä¸æ­£å¸¸ï¼ˆè®¡æ•°è¶…è¿‡5000ï¼Œä¹Ÿå°±æ˜¯ä¸¤æ¬¡ä¿¡å·æ—¶é—´è¶…è¿‡5sï¼‰ä¸æ˜¾ç¤ºæ•°æ®
 100   3                {
 101   4                 View_Data[0]=' ';
 102   4                 View_Data[1]=' ';
 103   4                 View_Data[2]=' ';
 104   4                }
 105   3      
 106   3               switch(View_Con)
 107   3                {
 108   4                 case 0: //æ­£å¸¸æ˜¾ç¤º
 109   4                        {
 110   5                                 lcd_1602_word(0x80,16,"Heart Rate:     ");//æ˜¾ç¤ºä¸€è¡Œæ•°æ®
 111   5                                 lcd_1602_word(0xc0,16,"                ");//æ˜¾ç¤ºç¬¬äºŒè¡Œæ•°æ®
 112   5                                 lcd_1602_word(0xcd,3,View_Data);                      //ç¬¬äºŒè¡Œæ˜¾ç¤ºå¿ƒç‡
 113   5                                 break;
 114   5                                }
 115   4                 case 1: //è®¾ç½®ä¸‹é™æ—¶æ˜¾ç¤º
C51 COMPILER V9.60.7.0   MAIN                                                              05/14/2024 01:41:02 PAGE 3   

 116   4                        {
 117   5                                 lcd_1602_word(0x80,16,"Heart Rate:     ");//ç¬¬ä¸€è¡Œæ˜¾ç¤ºå¿ƒç‡
 118   5                                 lcd_1602_word(0x8d,3,View_Data);
 119   5                                 
 120   5                                 View_L[0]=Xintiao_L/100+0x30;                //å°†ä¸‹é™æ•°æ®æ‹†å­—
 121   5                                 View_L[1]=Xintiao_L%100/10+0x30;
 122   5                                 View_L[2]=Xintiao_L%10+0x30;
 123   5      
 124   5                                 if(View_L[0]==0x30)                                  //æœ€é«˜ä½ä¸º0æ—¶ï¼Œä¸æ˜¾ç¤º
 125   5                                  View_L[0]=' ';
 126   5                                 
 127   5                                 lcd_1602_word(0xC0,16,"Warning L :     ");//ç¬¬äºŒè¡Œæ˜¾ç¤ºä¸‹é™æ•°æ®
 128   5                                 lcd_1602_word(0xCd,3,View_L);
 129   5                                 break;
 130   5                                }
 131   4                 case 2: //è®¾ç½®ä¸Šé™æ—¶æ˜¾ç¤ºï¼ˆåŒä¸Šï¼‰
 132   4                        {
 133   5                                 lcd_1602_word(0x80,16,"Heart Rate:     ");
 134   5                                 lcd_1602_word(0x8d,3,View_Data);
 135   5                                 
 136   5                                 View_H[0]=Xintiao_H/100+0x30;
 137   5                                 View_H[1]=Xintiao_H%100/10+0x30;
 138   5                                 View_H[2]=Xintiao_H%10+0x30;
 139   5      
 140   5                                 if(View_H[0]==0x30)
 141   5                                  View_H[0]=' ';
 142   5                                 
 143   5                                 lcd_1602_word(0xC0,16,"Warning H :     ");
 144   5                                 lcd_1602_word(0xCd,3,View_H);
 145   5                                 break;
 146   5                                }
 147   4                }
 148   3              }
 149   2        }
 150   1      }
 151          
 152          void Time1() interrupt 3                //å®šæ—¶å™¨1æœåŠ¡å‡½æ•°
 153          {
 154   1              static uchar Key_Con,Xintiao_Con;
 155   1              TH1=0xd8;                  //10ms
 156   1              TL1=0xf0;                  //é‡æ–°èµ‹åˆå€¼
 157   1              switch(Key_Con)   //æ— æŒ‰é”®æŒ‰ä¸‹æ—¶æ­¤å€¼ä¸º0
 158   1              {
 159   2                      case 0:            //æ¯10msæ‰«ææ­¤å¤„
 160   2                      {
 161   3                              if((P3&0x07)!=0x07)//æ‰«ææŒ‰é”®æ˜¯å¦æœ‰æŒ‰ä¸‹
 162   3                              {
 163   4                                      Key_Con++;                //æœ‰æŒ‰ä¸‹æ­¤å€¼åŠ 1ï¼Œå€¼ä¸º1
 164   4                              }
 165   3                              break;
 166   3                      }
 167   2                      case 1:                                   //10msåäºŒæ¬¡è¿›å…¥ä¸­æ–­åæ‰«ææ­¤å¤„ï¼ˆKey_Conä¸º1ï¼‰
 168   2                      {
 169   3                              if((P3&0x07)!=0x07)//ç¬¬äºŒæ¬¡è¿›å…¥ä¸­æ–­æ—¶ï¼ŒæŒ‰é”®ä»ç„¶æ˜¯æŒ‰ä¸‹ï¼ˆèµ·åˆ°æŒ‰é”®å»¶æ—¶å»æŠ–çš„ä½œç
             -”¨ï¼‰
 170   3                              {
 171   4                                      Key_Con++;                //å˜é‡åŠ 1ï¼Œå€¼ä¸º2
 172   4                                      switch(P3&0x07)  //åˆ¤æ–­æ˜¯å“ªä¸ªæŒ‰é”®æŒ‰ä¸‹
 173   4                                      {
 174   5                                              case 0x06:Key_Value=1;break;     //åˆ¤æ–­å¥½æŒ‰é”®åå°†é”®å€¼èµ‹å€¼ç»™å˜é‡Key_Value
 175   5                                              case 0x05:Key_Value=2;break;
 176   5                                              case 0x03:Key_Value=3;break;
C51 COMPILER V9.60.7.0   MAIN                                                              05/14/2024 01:41:02 PAGE 4   

 177   5                                      }
 178   4                              }
 179   3                              else                                                             //å¦‚æœ10msæ—¶æ²¡æœ‰æ£€æµ‹åˆ°æŒ‰é”®æŒ‰ä¸‹ï¼ˆæŒ‰ä¸‹æ—¶é—´è¿‡çŸ­ï¼‰
 180   3                              {
 181   4                                      Key_Con=0;                                               //å˜é‡æ¸…é›¶ï¼Œé‡æ–°æ£€æµ‹æŒ‰é”®
 182   4                              }
 183   3                              break;
 184   3                      }
 185   2                      case 2:                                                                  //20msåæ£€æµ‹æŒ‰é”®
 186   2                      {
 187   3                              if((P3&0x07)==0x07)                              //æ£€æµ‹æŒ‰é”®æ˜¯å¦è¿˜æ˜¯æŒ‰ä¸‹çŠ¶æ€
 188   3                              {
 189   4                                      Key_Change=1;                                    //æœ‰æŒ‰é”®æŒ‰ä¸‹ä½¿èƒ½å˜é‡ï¼Œï¼ˆæ­¤å˜é‡ä¸º1æ—¶æ‰ä¼šå¤„ç†é”®å€¼æ•°æ®ï¼‰
 190   4                                      Key_Con=0;                                              //å˜é‡æ¸…é›¶ï¼Œç­‰å¾…ä¸‹æ¬¡æœ‰æŒ‰é”®æŒ‰ä¸‹
 191   4                              }
 192   3                              break;
 193   3                      }
 194   2              }
 195   1              
 196   1              switch (Xintiao_Con)//æ­¤å¤„ä¸ä¸Šé¢æŒ‰é”®çš„æ£€æµ‹ç±»ä¼¼
 197   1              {
 198   2                      case 0:                  //é»˜è®¤Xintiao_Conæ˜¯ä¸º0çš„
 199   2                      {
 200   3                              if(!Xintiao)//æ¯10msï¼ˆä¸Šé¢çš„å®šæ—¶å™¨ï¼‰æ£€æµ‹ä¸€æ¬¡è„‰ææ˜¯å¦æœ‰ä¿¡å·
 201   3                              {
 202   4                                      Xintiao_Con++;//å¦‚æœæœ‰ä¿¡å·ï¼Œå˜é‡åŠ ä¸€ï¼Œç¨‹åºå°±ä¼šå¾€ä¸‹èµ°äº†
 203   4                              }
 204   3                              break;
 205   3                      }
 206   2                      case 1:
 207   2                      {
 208   3                              if(!Xintiao)       //æ¯è¿‡10msæ£€æµ‹ä¸€ä¸‹ä¿¡å·æ˜¯å¦è¿˜å­˜åœ¨
 209   3                              {
 210   4                                      Xintiao_Con++;//å­˜åœ¨å°±åŠ ä¸€
 211   4                              }
 212   3                              else
 213   3                              {
 214   4                                      Xintiao_Con=0;//å¦‚æœä¸å­˜åœ¨äº†ï¼Œæ£€æµ‹æ—¶é—´å¾ˆçŸ­ï¼Œè¯´æ˜æ£€æµ‹åˆ°çš„ä¸æ˜¯è„‰æä¿¡å·ï¼Œå¯èƒ
             -½æ˜¯å…¶ä»–å¹²æ‰°ï¼Œå°†å˜é‡æ¸…é›¶ï¼Œè·³å‡ºæ­¤æ¬¡æ£€æµ‹
 215   4                              } 
 216   3                              break;
 217   3                      }
 218   2                      case 2:
 219   2                      {
 220   3                              if(!Xintiao)
 221   3                              {
 222   4                                      Xintiao_Con++;//å­˜åœ¨å°±åŠ ä¸€
 223   4                              }
 224   3                              else
 225   3                              {
 226   4                                      Xintiao_Con=0;//å¦‚æœä¸å­˜åœ¨äº†ï¼Œæ£€æµ‹æ—¶é—´å¾ˆçŸ­ï¼Œè¯´æ˜æ£€æµ‹åˆ°çš„ä¸æ˜¯è„‰æä¿¡å·ï¼Œå¯èƒ
             -½æ˜¯å…¶ä»–å¹²æ‰°ï¼Œå°†å˜é‡æ¸…é›¶ï¼Œè·³å‡ºæ­¤æ¬¡æ£€æµ‹
 227   4                              } 
 228   3                              break;
 229   3                      }
 230   2                      case 3:
 231   2                      {
 232   3                              if(!Xintiao)
 233   3                              {
 234   4                                      Xintiao_Con++;//å­˜åœ¨å°±åŠ ä¸€
 235   4                              }
 236   3                              else
C51 COMPILER V9.60.7.0   MAIN                                                              05/14/2024 01:41:02 PAGE 5   

 237   3                              {
 238   4                                      Xintiao_Con=0;//å¦‚æœä¸å­˜åœ¨äº†ï¼Œæ£€æµ‹æ—¶é—´å¾ˆçŸ­ï¼Œè¯´æ˜æ£€æµ‹åˆ°çš„ä¸æ˜¯è„‰æä¿¡å·ï¼Œå¯èƒ
             -½æ˜¯å…¶ä»–å¹²æ‰°ï¼Œå°†å˜é‡æ¸…é›¶ï¼Œè·³å‡ºæ­¤æ¬¡æ£€æµ‹
 239   4                              } 
 240   3                              break;
 241   3                      }
 242   2                      case 4:
 243   2                      {
 244   3                              if(Xintiao)//è¶…è¿‡30msæœ‰ä¿¡å·ï¼Œåˆ¤å®šæ­¤æ¬¡æ˜¯è„‰æä¿¡å·ï¼Œç„¶åå½“ä¿¡å·æ¶ˆå¤±åï¼Œæ‰§è¡Œä»¥ä¸
             -‹ç¨‹åº
 245   3                              {
 246   4                                      if(Xintiao_Change==1)//å¿ƒç‡è®¡åŸç†ä¸ºæ£€æµ‹ä¸¤æ¬¡è„‰å†²é—´éš”æ—¶é—´è®¡ç®—å¿ƒç‡ï¼Œå˜é‡Xintiao_Ch
             -angeç¬¬ä¸€æ¬¡è„‰å†²æ—¶ä¸º0çš„ï¼Œæ‰€æœ‰èµ°ä¸‹é¢çš„elseï¼Œç¬¬äºŒæ¬¡èµ°è¿™é‡Œ
 247   4                                      {
 248   5                                              View_Data[0]=(60000/Xintiao_Jishu)/100+0x30;              //è®¡ç®—å¿ƒè·³å¹¶æ‹†å­—æ˜¾ç¤ºï¼šå¿ƒè·³è®¡æ—¶æ˜¯ä»¥1ms
             -ä¸ºå•ä½ï¼Œä¸¤æ¬¡å¿ƒè·³ä¸­é—´è®¡æ•°å¦‚æœæ˜¯1000æ¬¡ï¼Œä¹Ÿå°±æ˜¯1000*1ms=1000ms=1s
 249   5                                              View_Data[1]=(60000/Xintiao_Jishu)%100/10+0x30;   //é‚£ä¹ˆè®¡ç®—å‡ºçš„ä¸€åˆ†é’Ÿï¼ˆ60sï¼‰å¿ƒè·³æ•°å°±æ
             -˜¯ï¼š60*1000/ï¼ˆ1000*1msï¼‰=60æ¬¡       å…¶ä¸­60æ˜¯ä¸€åˆ†é’Ÿ60sï¼Œ1000æ˜¯ä¸€ç§’æœ‰1000msï¼Œ1000æ˜¯è®¡æ•°å€¼ï¼Œ1æ˜¯ä¸€æ¬¡è®¡æ
             -•°å¯¹åº” çš„æ—¶é—´æ˜¯1ms
 250   5                                              View_Data[2]=(60000/Xintiao_Jishu)%10+0x30;               //è®¡ç®—å‡ºçš„å¿ƒè·³æ•°/100å¾—åˆ°å¿ƒè·³çš„ç™¾ä½ï¼Œ%10
             -0æ˜¯å–ä½™çš„ï¼Œå°±æ˜¯é™¤ä»¥100çš„ä½™æ•°ï¼Œå†é™¤ä»¥10å°±å¾—åˆ°åä½äº†ï¼Œä»¥æ­¤ç±»æ¨
 251   5                                                                                                        //æ‹†å­—åçš„å•ä¸ªæ•°æ®+0x30çš„ç›®çš„æ˜¯å¾—åˆ°å¯¹åº”æ•°å­—çš„æ¶²æ™¶æ˜¾ç¤ºç ï¼Œæ•°å­—0å¯¹
             -åº”çš„æ¶²æ™¶æ˜¾ç¤ºç æ˜¯0x30ï¼Œ1æ˜¯0x30+1ï¼Œä»¥æ­¤ç±»æ¨
 252   5                                              if(((60000/Xintiao_Jishu)>=Xintiao_H)||((60000/Xintiao_Jishu)<=Xintiao_L))//å¿ƒç‡ä¸åœ¨èŒƒå›´å†…æŠ¥è
             -­¦
 253   5                                              speaker=0;                      //èœ‚é¸£å™¨å“
 254   5                                              else
 255   5                                              speaker=1;                      //ä¸å“
 256   5                                              
 257   5                                              View_Change=1;     //è®¡ç®—å‡ºå¿ƒç‡åå¯åŠ¨æ˜¾ç¤º
 258   5                                              Xintiao_Jishu=0;           //å¿ƒè·³è®¡æ•°æ¸…é›¶
 259   5                                              Xintiao_Change=0;   //è®¡ç®—å‡ºå¿ƒç‡åè¯¥å˜é‡æ¸…é›¶ï¼Œå‡†å¤‡ä¸‹æ¬¡æ£€æµ‹å¿ƒç‡
 260   5                                              stop=0;                    //è®¡ç®—å‡ºå¿ƒç‡åstopæ¸…é›¶
 261   5                                      }
 262   4                                      else//ç¬¬ä¸€æ¬¡è„‰å†²æ—¶Xintiao_Changeä¸º0
 263   4                                      {
 264   5                                              Xintiao_Jishu=0;        //è„‰å†²è®¡æ—¶å˜é‡æ¸…é›¶ï¼Œå¼€å§‹è®¡æ—¶
 265   5                                              Xintiao_Change=1;//Xintiao_Changeç½®1ï¼Œå‡†å¤‡ç¬¬äºŒæ¬¡æ£€æµ‹åˆ°è„‰å†²æ—¶è®¡ç®—å¿ƒç‡
 266   5                                      }
 267   4                                      Xintiao_Con=0;  //æ¸…é›¶ï¼Œå‡†å¤‡æ£€æµ‹ä¸‹ä¸€æ¬¡è„‰å†²
 268   4                                      break;
 269   4                              }
 270   3                      }
 271   2              }
 272   1      }
 273          /**å®šæ—¶å™¨T0å·¥ä½œå‡½æ•°**/
 274          void Time0() interrupt 1
 275          {
 276   1       TH0=0xfc;                 //1ms
 277   1       TL0=0x18;                 //é‡æ–°èµ‹åˆå€¼
 278   1       Xintiao_Jishu++;  //å¿ƒè·³è®¡æ•°åŠ 
 279   1       if(Xintiao_Jishu==5000)//å¿ƒè·³è®¡æ•°å¤§äº5000
 280   1        {
 281   2         Xintiao_Jishu=0;             //æ•°æ®æ¸…é›¶
 282   2         View_Change=1;               //æ˜¾ç¤ºä½ç½®1
 283   2         Xintiao_Change=0;    //ç½®é›¶ï¼Œå‡†å¤‡å†æ¬¡æ£€æµ‹
 284   2         stop=1;         //å¿ƒè·³è®¡æ•°è¶…è¿‡5000åè¯´æ˜å¿ƒç‡ä¸æ­£å¸¸æˆ–è€…æ²¡æœ‰æµ‹å‡ºï¼Œstopç½®1
 285   2         speaker=1;  //å…³é—­èœ‚é¸£å™¨
 286   2        }
 287   1      }
 288          /**å®šæ—¶å™¨åˆå§‹åŒ–å‡½æ•°**/
 289          void Tim_Init()
C51 COMPILER V9.60.7.0   MAIN                                                              05/14/2024 01:41:02 PAGE 6   

 290          {
 291   1       EA=1;                    //æ‰“å¼€ä¸­æ–­æ€»å¼€å…³
 292   1       ET0=1;                   //æ‰“å¼€T0ä¸­æ–­å…è®¸å¼€å…³
 293   1       ET1=1;                   //æ‰“å¼€T1ä¸­æ–­å…è®¸å¼€å…³
 294   1       TMOD=0x11;               //è®¾å®šå®šæ—¶å™¨çŠ¶æ€
 295   1       TH0=0xfc;                 //1ms
 296   1       TL0=0x18;                 //èµ‹åˆå€¼
 297   1       
 298   1       TH1=0xd8;                 //10ms
 299   1       TL1=0xf0;                 //èµ‹åˆå€¼
 300   1      }
 301          /**åœ¨æŒ‡å®šåœ°å€æ˜¾ç¤ºæŒ‡å®šæ•°é‡çš„æŒ‡å®šå­—ç¬¦**/
 302          /**Adress_Comæ˜¾ç¤ºåœ°å€ï¼ŒNum_Adatæ˜¾ç¤ºå­—ç¬¦æ•°é‡ï¼ŒAdress_Dataæ˜¾ç¤ºå­—ç¬¦ä¸²å†…å®¹**/ 
 303          void lcd_1602_word(uchar Adress_Com,uchar Num_Adat,uchar *Adress_Data)
 304          {
 305   1       uchar a=0;
 306   1       uchar Data_Word;
 307   1       LCD_WriteCom(Adress_Com); //é€‰ä¸­åœ°å€
 308   1       for(a=0;a<Num_Adat;a++)   //forå¾ªç¯å†³å®šæ˜¾ç¤ºå­—ç¬¦ä¸ªæ•°
 309   1        {
 310   2         Data_Word=*Adress_Data;        //è¯»å–å­—ç¬¦ä¸²æ•°æ®
 311   2         LCD_WriteData(Data_Word);  //æ˜¾ç¤ºå­—ç¬¦ä¸²
 312   2         Adress_Data++;                         //æ˜¾ç¤ºåœ°å€åŠ ä¸€
 313   2        }
 314   1      }
 315          
 316          /***************1602å‡½æ•°*******************/
 317          void LCD_WriteData(uchar LCD_1602_DATA)  /********LCD1602æ•°æ®å†™å…¥***********/
 318          {
 319   1       delay5ms();  //æ“ä½œå‰çŸ­æš‚å»¶æ—¶ï¼Œä¿è¯ä¿¡å·ç¨³å®š
 320   1       LCD_E=0;
 321   1       LCD_RS=1;
 322   1       LCD_RW=0;
 323   1       _nop_();
 324   1       LCD_E=1;
 325   1       LCD_DATA=LCD_1602_DATA;
 326   1       LCD_E=0;
 327   1       LCD_RS=0;
 328   1      }
 329          
 330          /********LCD1602å‘½ä»¤å†™å…¥***********/
 331          void LCD_WriteCom(uchar LCD_1602_COM)
 332          {
 333   1       delay5ms();//æ“ä½œå‰çŸ­æš‚å»¶æ—¶ï¼Œä¿è¯ä¿¡å·ç¨³å®š
 334   1       LCD_E=0;
 335   1       LCD_RS=0;
 336   1       LCD_RW=0;
 337   1       _nop_();
 338   1       LCD_E=1;
 339   1       LCD_DATA=LCD_1602_COM;
 340   1       LCD_E=0;
 341   1       LCD_RS=0;
 342   1      }
 343          
 344          
 345          void InitLcd()             //åˆå§‹åŒ–æ¶²æ™¶å‡½æ•°
 346          {
 347   1       delay5ms();
 348   1       delay5ms();
 349   1       LCD_WriteCom(0x38); //display mode
 350   1       LCD_WriteCom(0x38); //display mode
 351   1       LCD_WriteCom(0x38); //display mode
C51 COMPILER V9.60.7.0   MAIN                                                              05/14/2024 01:41:02 PAGE 7   

 352   1       LCD_WriteCom(0x06); //æ˜¾ç¤ºå…‰æ ‡ç§»åŠ¨ä½ç½®
 353   1       LCD_WriteCom(0x0c); //æ˜¾ç¤ºå¼€åŠå…‰æ ‡è®¾ç½®
 354   1       LCD_WriteCom(0x01); //æ˜¾ç¤ºæ¸…å±
 355   1       delay5ms();
 356   1       delay5ms();
 357   1      }
 358          
 359          void delay5ms(void)   //5mså»¶æ—¶å‡½æ•°
 360          {
 361   1          unsigned char a,b;
 362   1          for(b=185;b>0;b--)
 363   1              for(a=12;a>0;a--);
 364   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1055    ----
   CONSTANT SIZE    =     68    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     21       8
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
